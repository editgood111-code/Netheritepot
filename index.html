<!DOCTYPE html>
<html lang="en" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rankings | NetheritePot</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-app: #09090b;
    --bg-card: #131316;
    --bg-strip: #1c1c21;
    --border: #27272a;
    --text-main: #fafafa;
    --text-muted: #a1a1aa;
    --accent: #ef4444;
    --t1: #ef4444; --t2: #f97316; --t3: #eab308; --t4: #22c55e; --t5: #3b82f6;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background-color: var(--bg-app); color: var(--text-main); font-family: 'Inter', sans-serif; min-height: 100vh; }

  /* --- NAVIGATION --- */
  .navbar {
    position: sticky; top: 0; z-index: 50; background: rgba(9, 9, 11, 0.9);
    backdrop-filter: blur(12px); border-bottom: 1px solid var(--border);
  }
  .nav-content {
    max-width: 1400px; margin: 0 auto; height: 72px;
    display: flex; align-items: center; justify-content: space-between; padding: 0 24px;
  }
  .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 22px; cursor: pointer; }
  .brand img { width: 28px; height: 28px; }

  .nav-links { display: flex; gap: 20px; align-items: center; }
  .discord-btn {
    display: flex; align-items: center; gap: 8px; background: #5865F2; color: white;
    padding: 8px 16px; border-radius: 8px; text-decoration: none; font-weight: 600; font-size: 14px; transition: 0.2s;
  }
  .discord-btn:hover { background: #4752c4; }
  .discord-btn img { width: 20px; }

  /* --- TABS --- */
  .container { max-width: 1400px; margin: 40px auto; padding: 0 24px; }
  .tab-container { display: flex; gap: 8px; margin-bottom: 24px; border-bottom: 1px solid var(--border); padding-bottom: 1px; }
  .tab {
    padding: 12px 24px; cursor: pointer; color: var(--text-muted); font-weight: 600;
    border-radius: 12px 12px 0 0; border: 1px solid transparent; transition: 0.2s;
  }
  .tab.active {
    color: #fff; background: var(--bg-card); border: 1px solid var(--border); border-bottom: 2px solid var(--accent);
  }

  /* --- OVERALL VIEW (TOP 10) --- */
  .overall-list { display: flex; flex-direction: column; gap: 8px; max-width: 800px; margin: 0 auto; }
  .leaderboard-item {
    display: flex; align-items: center; gap: 15px; padding: 15px 20px;
    background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px;
  }
  .rank-num { font-size: 20px; font-weight: 800; width: 30px; color: var(--accent); }

  /* --- NETHOP VIEW (GRID) --- */
  .tier-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; }
  .tier-col { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; }
  .col-header { height: 50px; display: flex; align-items: center; justify-content: center; font-weight: 800; }
  .player-list { padding: 10px; display: flex; flex-direction: column; gap: 6px; }

  /* --- SHARED PLAYER STRIP --- */
  .player-strip {
    display: flex; align-items: center; gap: 10px; padding: 8px; border-radius: 8px;
    background: var(--bg-strip); cursor: pointer; transition: 0.2s;
  }
  .player-strip:hover { transform: scale(1.02); background: #27272a; }
  .p-avatar { width: 32px; height: 32px; border-radius: 6px; }
  .p-name { font-weight: 600; font-size: 14px; flex-grow: 1; }
  .p-pts { font-size: 11px; font-weight: 700; color: var(--text-muted); background: rgba(255,255,255,0.05); padding: 2px 6px; border-radius: 4px; }

  /* --- MODAL --- */
  .modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px);
    z-index: 100; display: none; align-items: center; justify-content: center;
  }
  .modal-overlay.open { display: flex; }
  .modal-card { width: 440px; background: #18181b; border: 1px solid var(--border); border-radius: 28px; position: relative; padding: 30px; text-align: center; }
  .close-btn { position: absolute; top: 15px; right: 15px; background: none; border: none; color: #fff; cursor: pointer; font-size: 20px; }
  .modal-bust { width: 120px; margin-bottom: 15px; }

  @media (max-width: 1100px) { .tier-grid { grid-template-columns: 1fr; } }
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

  <nav class="navbar">
    <div class="nav-content">
      <div class="brand" onclick="location.reload()">
        <img src="https://mctiers.com/tier_icons/nethop.svg">
        NetheritePot
      </div>
      <div class="nav-links">
        <a href="https://discord.gg/accNzNbEu4" target="_blank" class="discord-btn">
          <img src="https://cdn.prod.website-files.com/6257adef93867e3d0394e0ff/636e0a22aa5342cf127ad928_icon_clyde_white_RGB.svg">
          Join Discord
        </a>
      </div>
    </div>
  </nav>

  <div class="container">
    <div class="tab-container">
      <div class="tab active" id="tab-overall" onclick="switchView('overall')">Overall</div>
      <div class="tab" id="tab-nethpot" onclick="switchView('nethpot')">NethPot</div>
    </div>

    <div id="view-overall" class="overall-list"></div>
    <div id="view-nethpot" class="tier-grid" style="display:none"></div>
  </div>

  <div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
    <div class="modal-card">
      <button class="close-btn" onclick="closeModal(null, true)">âœ•</button>
      <img id="m-bust" class="modal-bust" src="">
      <h2 id="m-name" style="font-size: 28px; margin-bottom: 10px;"></h2>
      <p id="m-tier-text" style="color: var(--text-muted); font-weight: 600;"></p>
      <div style="background: rgba(255,255,255,0.05); padding: 15px; border-radius: 12px; margin-top: 20px;">
        <span style="display:block; font-size: 12px; color: var(--text-muted);">POINTS</span>
        <span id="m-pts" style="font-size: 24px; font-weight: 800;"></span>
      </div>
    </div>
  </div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB3FWTZ587KxVbe1POuw-2Rk5FSrcpZ_QU",
  authDomain: "tierlist-3305a.firebaseapp.com",
  databaseURL: "https://tierlist-3305a-default-rtdb.firebaseio.com",
  projectId: "tierlist-3305a",
  storageBucket: "tierlist-3305a.firebasestorage.app",
  appId: "1:410709885310:web:ceab1ca94e0f45513f332f"
};

const POINT_MAP = {
  "HT1": 60, "LT1": 45, "HT2": 30, "LT2": 20, "HT3": 10, "LT3": 6, "HT4": 4, "LT4": 3, "HT5": 2, "LT5": 1,
  "RHT1": 60, "RLT1": 45, "RHT2": 30, "RLT2": 20, "RHT3": 10, "RLT3": 6, "RHT4": 4, "RLT4": 3, "RHT5": 2, "RLT5": 1
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
let players = [];

db.ref("players").on("value", snap => {
  const val = snap.val();
  players = val ? (Array.isArray(val) ? val : Object.values(val)) : [];
  renderViews();
});

function switchView(view) {
  document.getElementById('view-overall').style.display = view === 'overall' ? 'flex' : 'none';
  document.getElementById('view-nethpot').style.display = view === 'nethpot' ? 'grid' : 'none';
  document.getElementById('tab-overall').className = view === 'overall' ? 'tab active' : 'tab';
  document.getElementById('tab-nethpot').className = view === 'nethpot' ? 'tab active' : 'tab';
}

function parse(p) {
  const tier = (p.tier || "").toUpperCase();
  return { ...p, points: POINT_MAP[tier] || 0, isRetired: tier.startsWith("R"), tier };
}

function renderViews() {
  const parsedPlayers = players.map(parse);

  // --- OVERALL (TOP 10) ---
  const overallDiv = document.getElementById("view-overall");
  overallDiv.innerHTML = `<h2 style="margin-bottom:20px; font-size: 22px;">Top 10 Global Players</h2>`;
  const top10 = [...parsedPlayers].sort((a,b) => b.points - a.points).slice(0, 10);
  
  top10.forEach((p, i) => {
    const item = document.createElement("div");
    item.className = "leaderboard-item";
    item.innerHTML = `
      <div class="rank-num">#${i+1}</div>
      <img class="p-avatar" src="https://mc-heads.net/avatar/${p.name}/64">
      <div class="p-name">${p.name}</div>
      <div class="p-pts">${p.points} pts</div>
    `;
    item.onclick = () => openModal(p);
    overallDiv.appendChild(item);
  });

  // --- NETHPOT (GRID) ---
  const grid = document.getElementById("view-nethpot");
  grid.innerHTML = "";
  ["T1", "T2", "T3", "T4", "T5"].forEach(t => {
    const col = document.createElement("div");
    col.className = "tier-col";
    col.innerHTML = `<div class="col-header" style="background:var(--${t.toLowerCase()})">Tier ${t.slice(1)}</div>`;
    const list = document.createElement("div");
    list.className = "player-list";
    
    parsedPlayers.filter(p => !p.isRetired && p.tier.includes(t.slice(1)))
      .sort((a,b) => b.points - a.points)
      .forEach(p => {
        const item = document.createElement("div");
        item.className = "player-strip";
        item.innerHTML = `<img class="p-avatar" src="https://mc-heads.net/avatar/${p.name}/64"><div class="p-name">${p.name}</div><div class="p-pts">${p.points}</div>`;
        item.onclick = () => openModal(p);
        list.appendChild(item);
      });
    col.appendChild(list);
    grid.appendChild(col);
  });
}

function openModal(p) {
  document.getElementById("m-name").innerText = p.name;
  document.getElementById("m-pts").innerText = p.points;
  document.getElementById("m-tier-text").innerText = p.tier;
  document.getElementById("m-bust").src = `https://render.crafty.gg/3d/bust/${p.name}`;
  document.getElementById("modal-overlay").classList.add("open");
}

function closeModal(e, force) { if(force || (e && e.target.id === 'modal-overlay')) document.getElementById("modal-overlay").classList.remove("open"); }
</script>
</body>
</html>
