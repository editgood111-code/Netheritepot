<!DOCTYPE html>
<html lang="en" class="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rankings | NetheritePot</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-app: #09090b;
    --bg-card: #131316;
    --bg-strip: #1c1c21;
    --border: #27272a;
    --text-main: #fafafa;
    --text-muted: #a1a1aa;
    --accent: #eab308;
    
    /* Tier Colors */
    --t1: #ef4444; --t2: #f97316; --t3: #eab308; --t4: #22c55e; --t5: #3b82f6;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }
  body { background-color: var(--bg-app); color: var(--text-main); font-family: 'Inter', sans-serif; min-height: 100vh; overflow-y: scroll; }

  /* --- NAVIGATION --- */
  .navbar {
    position: sticky; top: 0; z-index: 50; background: rgba(9, 9, 11, 0.9);
    backdrop-filter: blur(12px); border-bottom: 1px solid var(--border);
  }
  .nav-content {
    max-width: 1400px; margin: 0 auto; height: 72px;
    display: flex; align-items: center; justify-content: space-between; padding: 0 24px;
  }
  .brand { display: flex; align-items: center; gap: 10px; font-weight: 800; font-size: 22px; letter-spacing: -0.5px; }
  .brand img { width: 24px; height: 24px; }

  .search-input {
    background: var(--bg-card); border: 1px solid var(--border);
    padding: 10px 16px; border-radius: 8px; color: #fff; font-size: 14px; width: 260px; outline: none;
  }
  .search-input:focus { border-color: var(--text-muted); }

  /* --- BOARD --- */
  .container { max-width: 1400px; margin: 40px auto; padding: 0 24px; }
  .tier-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; }

  .tier-col { background: var(--bg-card); border: 1px solid var(--border); border-radius: 14px; overflow: hidden; display: flex; flex-direction: column; }
  .col-header {
    height: 50px; display: flex; align-items: center; justify-content: center;
    font-weight: 800; font-size: 16px; text-transform: uppercase; color: #fff;
  }

  .player-list { padding: 10px; display: flex; flex-direction: column; gap: 6px; }

  /* --- PLAYER STRIP --- */
  .player-strip {
    display: flex; align-items: center; gap: 10px; padding: 8px; border-radius: 8px;
    background: var(--bg-strip); cursor: pointer; transition: 0.2s; border: 1px solid transparent;
  }
  .player-strip:hover { transform: scale(1.02); background: #27272a; border-color: #3f3f46; }
  .player-strip.retired { opacity: 0.5; filter: grayscale(1); }

  .p-avatar { width: 32px; height: 32px; border-radius: 6px; background: #000; }
  .p-name { font-weight: 600; font-size: 14px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
  
  .region-indicator { width: 4px; height: 20px; border-radius: 2px; }

  /* --- MODAL --- */
  .modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.8); backdrop-filter: blur(8px);
    z-index: 100; display: none; align-items: center; justify-content: center;
  }
  .modal-overlay.open { display: flex; }

  .modal-card {
    width: 440px; background: #18181b; border: 1px solid var(--border);
    border-radius: 28px; overflow: hidden; position: relative;
    box-shadow: 0 25px 50px -12px rgba(0,0,0,0.7);
  }

  .modal-hero {
    height: 160px; background: linear-gradient(to bottom, #27272a, #18181b);
    display: flex; justify-content: center; align-items: flex-end;
  }
  .modal-bust { width: 150px; height: 150px; transform: translateY(20px); filter: drop-shadow(0 10px 15px rgba(0,0,0,0.5)); }

  .modal-content { padding: 40px 30px 30px 30px; text-align: center; }
  .m-name { font-size: 32px; font-weight: 800; color: #fff; margin-bottom: 15px; }
  
  .m-details { 
    display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px;
  }
  .m-box { 
    background: rgba(255,255,255,0.03); border: 1px solid var(--border);
    padding: 15px; border-radius: 16px;
  }
  .m-label { font-size: 11px; font-weight: 700; color: var(--text-muted); text-transform: uppercase; margin-bottom: 5px; display: block;}
  .m-val { font-size: 18px; font-weight: 800; color: #fff; display: flex; align-items: center; justify-content: center; gap: 6px; }
  .m-val img { width: 18px; height: 18px; }

  .close-btn {
    position: absolute; top: 20px; right: 20px; width: 36px; height: 36px;
    background: rgba(0,0,0,0.4); border: none; border-radius: 50%; color: #fff;
    font-size: 20px; cursor: pointer; z-index: 10;
  }

  @media (max-width: 1100px) { .tier-grid { grid-template-columns: 1fr; } }
</style>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
</head>
<body>

  <nav class="navbar">
    <div class="nav-content">
      <div class="brand">
        <img src="https://mctiers.com/tier_icons/nethop.svg" alt="icon">
        NetheritePot
      </div>
      <input type="text" id="search" class="search-input" placeholder="Search for a player..." onkeyup="renderBoard()">
    </div>
  </nav>

  <div class="container">
    <div class="tier-grid" id="grid">
      </div>
  </div>

  <div class="modal-overlay" id="modal-overlay" onclick="closeModal(event)">
    <div class="modal-card">
      <button class="close-btn" onclick="closeModal(force=true)">âœ•</button>
      <div class="modal-hero">
        <img id="m-bust" class="modal-bust" src="" alt="Player Bust">
      </div>
      <div class="modal-content">
        <div id="m-name" class="m-name">Username</div>
        
        <div class="m-details">
          <div class="m-box">
            <span class="m-label">Region</span>
            <span id="m-region" class="m-val">NA</span>
          </div>
          <div class="m-box">
            <span class="m-label">Ranking</span>
            <span id="m-tier" class="m-val">
              <img src="https://mctiers.com/tier_icons/nethop.svg">
              <span>HT1</span>
            </span>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyB3FWTZ587KxVbe1POuw-2Rk5FSrcpZ_QU",
  authDomain: "tierlist-3305a.firebaseapp.com",
  databaseURL: "https://tierlist-3305a-default-rtdb.firebaseio.com",
  projectId: "tierlist-3305a",
  storageBucket: "tierlist-3305a.firebasestorage.app",
  messagingSenderId: "410709885310",
  appId: "1:410709885310:web:ceab1ca94e0f45513f332f"
};

const TIER_DEFS = [
  { id: "T1", label: "Tier 1", color: "var(--t1)" },
  { id: "T2", label: "Tier 2", color: "var(--t2)" },
  { id: "T3", label: "Tier 3", color: "var(--t3)" },
  { id: "T4", label: "Tier 4", color: "var(--t4)" },
  { id: "T5", label: "Tier 5", color: "var(--t5)" }
];

firebase.initializeApp(firebaseConfig);
const db = firebase.database();
let players = [];

db.ref("players").on("value", snap => {
  const val = snap.val();
  players = val ? (Array.isArray(val) ? val : Object.values(val)) : [];
  renderBoard();
});

function parsePlayer(p) {
  const tier = (p.tier || "").toUpperCase();
  const name = p.name || p.username || "Unknown";
  const region = (p.region || "NA").toUpperCase();
  
  let colId = "T5";
  if(tier.includes("1")) colId = "T1";
  else if(tier.includes("2")) colId = "T2";
  else if(tier.includes("3")) colId = "T3";
  else if(tier.includes("4")) colId = "T4";

  return { 
    ...p, name, region, colId, 
    isHigh: tier.includes("HT"), 
    isRetired: tier.startsWith("R"),
    displayTier: tier
  };
}

function renderBoard() {
  const grid = document.getElementById("grid");
  const query = document.getElementById("search").value.toLowerCase();
  grid.innerHTML = "";

  TIER_DEFS.forEach(def => {
    const col = document.createElement("div");
    col.className = "tier-col";
    col.innerHTML = `<div class="col-header" style="background:${def.color}">${def.label}</div>`;
    
    const list = document.createElement("div");
    list.className = "player-list";

    const filtered = players.map(parsePlayer).filter(p => p.colId === def.id && p.name.toLowerCase().includes(query));
    
    // Sort High Tier -> Low Tier -> Retired
    filtered.sort((a,b) => {
      if(a.isRetired !== b.isRetired) return a.isRetired ? 1 : -1;
      if(a.isHigh !== b.isHigh) return b.isHigh ? 1 : -1;
      return a.name.localeCompare(b.name);
    });

    filtered.forEach(p => {
      const item = document.createElement("div");
      item.className = `player-strip ${p.isRetired ? 'retired' : ''}`;
      
      const regColor = p.region === "NA" ? "#3b82f6" : p.region === "EU" ? "#ef4444" : "#eab308";

      item.innerHTML = `
        <div class="region-indicator" style="background:${regColor}"></div>
        <img class="p-avatar" src="https://mc-heads.net/avatar/${p.name}/64">
        <div class="p-name">${p.name}</div>
      `;
      item.onclick = () => openModal(p);
      list.appendChild(item);
    });

    col.appendChild(list);
    grid.appendChild(col);
  });
}

function openModal(p) {
  document.getElementById("m-name").innerText = p.name;
  document.getElementById("m-region").innerText = p.region;
  document.getElementById("m-tier").innerHTML = `<img src="https://mctiers.com/tier_icons/nethop.svg"> <span>${p.displayTier}</span>`;
  document.getElementById("m-bust").src = `https://render.crafty.gg/3d/bust/${p.name}`;
  document.getElementById("modal-overlay").classList.add("open");
}

function closeModal(e, force = false) {
  if (force || e.target.id === "modal-overlay") {
    document.getElementById("modal-overlay").classList.remove("open");
  }
}
</script>
</body>
</html>
